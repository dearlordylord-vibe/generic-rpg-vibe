import { vi } from 'vitest';

// Mock phaser3spectorjs module
vi.mock('phaser3spectorjs', () => {
  return {
    default: {
      Spector: class {
        static instance = {
          displayUI: () => {},
          spyCanvas: () => {}
        }
      }
    }
  };
});

// Mock canvas and WebGL context for Phaser
class MockCanvas {
  getContext() {
    return {
      fillRect: () => {},
      clearRect: () => {},
      getImageData: () => ({ data: new Uint8Array() }),
      putImageData: () => {},
      createImageData: () => ({ data: new Uint8Array() }),
      setTransform: () => {},
      drawImage: () => {},
      save: () => {},
      restore: () => {},
      translate: () => {},
      rotate: () => {},
      scale: () => {},
      beginPath: () => {},
      moveTo: () => {},
      lineTo: () => {},
      closePath: () => {},
      stroke: () => {},
      fill: () => {},
    };
  }
}

// Mock WebGL for Phaser with minimum required interface
const mockWebGLContext = {
  new: () => ({} as WebGL2RenderingContext),
  prototype: {} as WebGL2RenderingContext,
  READ_BUFFER: 0,
  UNPACK_ROW_LENGTH: 0,
  UNPACK_SKIP_ROWS: 0,
  UNPACK_SKIP_PIXELS: 0,
  PACK_ROW_LENGTH: 0,
  PACK_SKIP_ROWS: 0,
  PACK_SKIP_PIXELS: 0,
  COLOR: 0,
  DEPTH: 0,
  STENCIL: 0,
  RED: 0,
  RGB8: 0,
  RGBA8: 0,
  RGB10_A2: 0,
  TEXTURE_BINDING_3D: 0,
  UNPACK_SKIP_IMAGES: 0,
  UNPACK_IMAGE_HEIGHT: 0,
  TEXTURE_3D: 0,
  TEXTURE_WRAP_R: 0,
  MAX_3D_TEXTURE_SIZE: 0,
  UNSIGNED_INT_2_10_10_10_REV: 0,
  MAX_ELEMENTS_VERTICES: 0,
  MAX_ELEMENTS_INDICES: 0,
  TEXTURE_MIN_LOD: 0,
  TEXTURE_MAX_LOD: 0,
  TEXTURE_BASE_LEVEL: 0,
  TEXTURE_MAX_LEVEL: 0,
  MIN: 0,
  MAX: 0,
  DEPTH_COMPONENT24: 0,
  MAX_TEXTURE_LOD_BIAS: 0,
  TEXTURE_COMPARE_MODE: 0,
  TEXTURE_COMPARE_FUNC: 0,
  CURRENT_QUERY: 0,
  QUERY_RESULT: 0,
  QUERY_RESULT_AVAILABLE: 0,
  STREAM_READ: 0,
  STREAM_COPY: 0,
  STATIC_READ: 0,
  STATIC_COPY: 0,
  DYNAMIC_READ: 0,
  DYNAMIC_COPY: 0,
  MAX_DRAW_BUFFERS: 0,
  DRAW_BUFFER0: 0,
  DRAW_BUFFER1: 0,
  DRAW_BUFFER2: 0,
  DRAW_BUFFER3: 0,
  DRAW_BUFFER4: 0,
  DRAW_BUFFER5: 0,
  DRAW_BUFFER6: 0,
  DRAW_BUFFER7: 0,
  DRAW_BUFFER8: 0,
  DRAW_BUFFER9: 0,
  DRAW_BUFFER10: 0,
  DRAW_BUFFER11: 0,
  DRAW_BUFFER12: 0,
  DRAW_BUFFER13: 0,
  DRAW_BUFFER14: 0,
  DRAW_BUFFER15: 0,
  MAX_FRAGMENT_UNIFORM_COMPONENTS: 0,
  MAX_VERTEX_UNIFORM_COMPONENTS: 0,
  FRAGMENT_SHADER_DERIVATIVE_HINT: 0,
  PIXEL_PACK_BUFFER: 0,
  PIXEL_UNPACK_BUFFER: 0,
  PIXEL_PACK_BUFFER_BINDING: 0,
  PIXEL_UNPACK_BUFFER_BINDING: 0,
  FLOAT_MAT2x3: 0,
  FLOAT_MAT2x4: 0,
  FLOAT_MAT3x2: 0,
  FLOAT_MAT3x4: 0,
  FLOAT_MAT4x2: 0,
  FLOAT_MAT4x3: 0,
  SRGB: 0,
  SRGB8: 0,
  SRGB8_ALPHA8: 0,
  COMPARE_REF_TO_TEXTURE: 0,
  RGBA32F: 0,
  RGB32F: 0,
  RGBA16F: 0,
  RGB16F: 0,
  VERTEX_ATTRIB_ARRAY_INTEGER: 0,
  MAX_ARRAY_TEXTURE_LAYERS: 0,
  MIN_PROGRAM_TEXEL_OFFSET: 0,
  MAX_PROGRAM_TEXEL_OFFSET: 0,
  MAX_VARYING_COMPONENTS: 0,
  TEXTURE_2D_ARRAY: 0,
  TEXTURE_BINDING_2D_ARRAY: 0,
  R11F_G11F_B10F: 0,
  UNSIGNED_INT_10F_11F_11F_REV: 0,
  RGB9_E5: 0,
  UNSIGNED_INT_5_9_9_9_REV: 0,
  TRANSFORM_FEEDBACK_BUFFER_MODE: 0,
  MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS: 0,
  TRANSFORM_FEEDBACK_VARYINGS: 0,
  TRANSFORM_FEEDBACK_BUFFER_START: 0,
  TRANSFORM_FEEDBACK_BUFFER_SIZE: 0,
  TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN: 0,
  RASTERIZER_DISCARD: 0,
  MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS: 0,
  MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS: 0,
  INTERLEAVED_ATTRIBS: 0,
  SEPARATE_ATTRIBS: 0,
  TRANSFORM_FEEDBACK_BUFFER: 0,
  TRANSFORM_FEEDBACK_BUFFER_BINDING: 0,
  RGBA32UI: 0,
  RGB32UI: 0,
  RGBA16UI: 0,
  RGB16UI: 0,
  RGBA8UI: 0,
  RGB8UI: 0,
  RGBA32I: 0,
  RGB32I: 0,
  RGBA16I: 0,
  RGB16I: 0,
  RGBA8I: 0,
  RGB8I: 0,
  RED_INTEGER: 0,
  RGB_INTEGER: 0,
  RGBA_INTEGER: 0,
  SAMPLER_2D_ARRAY: 0,
  SAMPLER_2D_ARRAY_SHADOW: 0,
  SAMPLER_CUBE_SHADOW: 0,
  UNSIGNED_INT_VEC2: 0,
  UNSIGNED_INT_VEC3: 0,
  UNSIGNED_INT_VEC4: 0,
  INT_SAMPLER_2D: 0,
  INT_SAMPLER_3D: 0,
  INT_SAMPLER_CUBE: 0,
  INT_SAMPLER_2D_ARRAY: 0,
  UNSIGNED_INT_SAMPLER_2D: 0,
  UNSIGNED_INT_SAMPLER_3D: 0,
  UNSIGNED_INT_SAMPLER_CUBE: 0,
  UNSIGNED_INT_SAMPLER_2D_ARRAY: 0,
  DEPTH_COMPONENT32F: 0,
  DEPTH32F_STENCIL8: 0,
  FLOAT_32_UNSIGNED_INT_24_8_REV: 0,
  FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING: 0,
  FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE: 0,
  FRAMEBUFFER_ATTACHMENT_RED_SIZE: 0,
  FRAMEBUFFER_ATTACHMENT_GREEN_SIZE: 0,
  FRAMEBUFFER_ATTACHMENT_BLUE_SIZE: 0,
  FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE: 0,
  FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE: 0,
  FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE: 0,
  FRAMEBUFFER_DEFAULT: 0,
  UNSIGNED_INT_24_8: 0,
  DEPTH24_STENCIL8: 0,
  UNSIGNED_NORMALIZED: 0,
  DRAW_FRAMEBUFFER_BINDING: 0,
  READ_FRAMEBUFFER: 0,
  DRAW_FRAMEBUFFER: 0,
  READ_FRAMEBUFFER_BINDING: 0,
  RENDERBUFFER_SAMPLES: 0,
  FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER: 0,
  MAX_COLOR_ATTACHMENTS: 0,
  COLOR_ATTACHMENT1: 0,
  COLOR_ATTACHMENT2: 0,
  COLOR_ATTACHMENT3: 0,
  COLOR_ATTACHMENT4: 0,
  COLOR_ATTACHMENT5: 0,
  COLOR_ATTACHMENT6: 0,
  COLOR_ATTACHMENT7: 0,
  COLOR_ATTACHMENT8: 0,
  COLOR_ATTACHMENT9: 0,
  COLOR_ATTACHMENT10: 0,
  COLOR_ATTACHMENT11: 0,
  COLOR_ATTACHMENT12: 0,
  COLOR_ATTACHMENT13: 0,
  COLOR_ATTACHMENT14: 0,
  COLOR_ATTACHMENT15: 0,
  FRAMEBUFFER_INCOMPLETE_MULTISAMPLE: 0,
  MAX_SAMPLES: 0,
  HALF_FLOAT: 0,
  RG: 0,
  RG_INTEGER: 0,
  R8: 0,
  RG8: 0,
  R16F: 0,
  R32F: 0,
  RG16F: 0,
  RG32F: 0,
  R8I: 0,
  R8UI: 0,
  R16I: 0,
  R16UI: 0,
  R32I: 0,
  R32UI: 0,
  RG8I: 0,
  RG8UI: 0,
  RG16I: 0,
  RG16UI: 0,
  RG32I: 0,
  RG32UI: 0,
  VERTEX_ARRAY_BINDING: 0,
  R8_SNORM: 0,
  RG8_SNORM: 0,
  RGB8_SNORM: 0,
  RGBA8_SNORM: 0,
  SIGNED_NORMALIZED: 0,
  COPY_READ_BUFFER: 0,
  COPY_WRITE_BUFFER: 0,
  COPY_READ_BUFFER_BINDING: 0,
  COPY_WRITE_BUFFER_BINDING: 0,
  UNIFORM_BUFFER: 0,
  UNIFORM_BUFFER_BINDING: 0,
  UNIFORM_BUFFER_START: 0,
  UNIFORM_BUFFER_SIZE: 0,
  MAX_VERTEX_UNIFORM_BLOCKS: 0,
  MAX_FRAGMENT_UNIFORM_BLOCKS: 0,
  MAX_COMBINED_UNIFORM_BLOCKS: 0,
  MAX_UNIFORM_BUFFER_BINDINGS: 0,
  MAX_UNIFORM_BLOCK_SIZE: 0,
  MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS: 0,
  MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS: 0,
  UNIFORM_BUFFER_OFFSET_ALIGNMENT: 0,
  ACTIVE_UNIFORM_BLOCKS: 0,
  UNIFORM_TYPE: 0,
  UNIFORM_SIZE: 0,
  UNIFORM_BLOCK_INDEX: 0,
  UNIFORM_OFFSET: 0,
  UNIFORM_ARRAY_STRIDE: 0,
  UNIFORM_MATRIX_STRIDE: 0,
  UNIFORM_IS_ROW_MAJOR: 0,
  UNIFORM_BLOCK_BINDING: 0,
  UNIFORM_BLOCK_DATA_SIZE: 0,
  UNIFORM_BLOCK_ACTIVE_UNIFORMS: 0,
  UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES: 0,
  UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER: 0,
  UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER: 0,
  INVALID_INDEX: 0,
  MAX_VERTEX_OUTPUT_COMPONENTS: 0,
  MAX_FRAGMENT_INPUT_COMPONENTS: 0,
  MAX_SERVER_WAIT_TIMEOUT: 0,
  OBJECT_TYPE: 0,
  SYNC_CONDITION: 0,
  SYNC_STATUS: 0,
  SYNC_FLAGS: 0,
  SYNC_FENCE: 0,
  SYNC_GPU_COMMANDS_COMPLETE: 0,
  UNSIGNALED: 0,
  SIGNALED: 0,
  ALREADY_SIGNALED: 0,
  TIMEOUT_EXPIRED: 0,
  CONDITION_SATISFIED: 0,
  WAIT_FAILED: 0,
  SYNC_FLUSH_COMMANDS_BIT: 0,
  VERTEX_ATTRIB_ARRAY_DIVISOR: 0,
  ANY_SAMPLES_PASSED: 0,
  ANY_SAMPLES_PASSED_CONSERVATIVE: 0,
  SAMPLER_BINDING: 0,
  RGB10_A2UI: 0,
  INT_2_10_10_10_REV: 0,
  TRANSFORM_FEEDBACK: 0,
  TRANSFORM_FEEDBACK_PAUSED: 0,
  TRANSFORM_FEEDBACK_ACTIVE: 0,
  TRANSFORM_FEEDBACK_BINDING: 0,
  COMPRESSED_R11_EAC: 0,
  COMPRESSED_SIGNED_R11_EAC: 0,
  COMPRESSED_RG11_EAC: 0,
  COMPRESSED_SIGNED_RG11_EAC: 0,
  COMPRESSED_RGB8_ETC2: 0,
  COMPRESSED_SRGB8_ETC2: 0,
  COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0,
  COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0,
  COMPRESSED_RGBA8_ETC2_EAC: 0,
  COMPRESSED_SRGB8_ALPHA8_ETC2_EAC: 0,
  TEXTURE_IMMUTABLE_FORMAT: 0,
  MAX_ELEMENT_INDEX: 0,
  TEXTURE_IMMUTABLE_LEVELS: 0,
  TIMEOUT_IGNORED: -1,
  MAX_CLIENT_WAIT_TIMEOUT_WEBGL: 0
} as unknown as typeof WebGL2RenderingContext;

// Mock WebGL for Phaser
global.WebGL2RenderingContext = mockWebGLContext;

// Mock HTMLCanvasElement
Object.defineProperty(global, 'HTMLCanvasElement', {
  value: MockCanvas,
});

// Mock window.focus
Object.defineProperty(global, 'focus', {
  value: () => {},
});

// Mock requestAnimationFrame
global.requestAnimationFrame = (callback) => setTimeout(callback, 0);
global.cancelAnimationFrame = (id) => clearTimeout(id); 